name: Continuous Integration - Demo Failure

on:
  pull_request:
    branches: [ main, master ]

jobs:
  demo-fail:
    name: Demo failing job (runs only when PR labeled 'demo-fail')
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '16'

      - name: Check PR labels and conditionally fail
        env:
          PR_LABELS: "${{ join(github.event.pull_request.labels.*.name, ',') }}"
        run: |
          echo "PR labels: $PR_LABELS"
          if echo "$PR_LABELS" | grep -wq "demo-fail"; then
            echo "Label 'demo-fail' present — intentionally failing this job."
            exit 1
          else
            echo "Label 'demo-fail' not present — ending job successfully."
            exit 0
          fi
